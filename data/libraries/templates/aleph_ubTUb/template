<?xml version="1.0" encoding="UTF-8"?>
<library-template>
<maxlimit matches="VerlÃ¤ngerungslimit erreicht"/>

<action id="connect">
    <page url="http://$server;/F/?func=bor-info" >
      <template>
        <head> 
        <title>PDS SSO</title> 
        <script>  
        <template:read source="text()" var="borInfoPage" regex="http://.*bor-info"/> <!-- assuming that login server is https and books are http -->
        </script> 
        </head> 
      </template>
    </page>
    <page url="$borInfoPage"/>
    <page url="https://$server;pds">
      <post name="func">login</post>
      <post name="calling_system">aleph</post>
      <post name="bor_id">$username;</post>
      <post name="bor_verification">$password;</post>      
      <post name="institute">TUK50</post>
      <post name="url">$borInfoPage;</post>
      
      <template>
        <template:switch-prioritized>
          <html>
            <head><title>relocate</title></head>
            <body>
            <noscript><a><template:read var="borInfoPage2" source="@href" regex="http://.*"/> </a></noscript>
            </body>
          </html>
          
          <html>
            <head><title>Login</title></head>
            <body>
              <TD class=msg><t:read var="raise()" source="deep-text()"/></td>
            </body>
          </html>
         </template:switch-prioritized>
      </template>      
    </page>
    
    
    <page url="$borInfoPage2;" templateFile="../aleph_base/loggedIn2007"/>-->
<!--    <error templateFile="loginerror"/>    -->
</action>

<action id="update-all">
  <page url="$bookPage;" templateFile="update"/>
</action>

<action id="update-single">
  <page url="$book.detailLink;" templateFile="../aleph_base/details"/>
</action>

<action id="extend-single">
  <page url="$book.extendLink;"/>
  <page url="$book.detailLink;" templateFile="../aleph_base/details"/>
</action>
</library-template>
