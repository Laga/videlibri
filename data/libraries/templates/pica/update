<?xml version="1.0" encoding="UTF-8"?>
<t:switch-prioritized>

<html>
  <a>Vormerkungen<t:s>reservations:=@href</t:s></a>?
  
  <table summary="list of loans - data">
    <template:read var="delete-current-books()"/>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td><!--title-->Titel</td>
      <td></td>
      <td></td>
      <td></td>
      <td><!--shelf mark-->Signatur</td>
      <td></td>
      <td></td>
      <td></td>
      <td><!--status-->Status</td>
      <td></td>
      <td></td>
      <td></td>
      <td><!--volume-->Band</td>
      <td></td>
      <td></td>
      <td></td>
      <td><!--expiry-->Leihfristende</td>
      <td></td>
      <td></td>
      <td></td>
      <td><!--reservations-->Vormerkungen</td>
      <td></td>
      <td></td>
      <td></td>
      <td><!--renewals-->Verl√§ngerungen</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    
    <tr> <td class="h2"></td> </tr>
    
    
    
    
    <template:loop>
    <tr>
      {book := object()}
      <td></td>
      <td >
        {book.extendId:=''}
        <input name="VB" type="checkbox">{book.extendId:=@value}</input>?
      </td>
      <td></td>
      <td></td>
      <td></td>
      <td>
        <template:read source="text()" var="book.title" regex="^[^/]*"/>
        <template:read source="text()" var="book.author" regex="^[^/]*/\s*(von)?\s*(.*)" submatch="2"/>
      </td>
  
      <td></td><td></td><td></td><td class="value-small">{$book.id}</td>
      <td></td><td></td><td></td><td class="value-small">
        <template:switch value="$book.extendId">
          <template:if value="''">
            <template:switch value="filter(., 'Abholregal|Vormerkung|bestellt')">
              <template:if value="'Abholregal'">
                {book.status := ., book.statusId := 'provided'}
              </template:if>
              <template:if value="'Vormerkung'">
                {book.status := ., book.statusId := 'ordered'}
              </template:if>
              <template:if value="'bestellt'">
                {book.status := ., book.statusId := 'ordered'}
              </template:if>
              <template:read var="book.status:problematic" source="."/>
            </template:switch>
          </template:if>
          <template:read var="book.status:curious" source="."/>
        </template:switch>
      </td>
      <td></td><td></td><td></td><td class="value-small"></td>
      <td></td><td></td><td></td><td class="value-small">
        <template:if test="text()!=''"><template:read source="." var="book.duedate:dd-mm-yyyy"/></template:if>
      </td>
      <td></td><td></td><td></td><td class="value-small"></td>
      <td></td><td></td><td></td><td class="value-small"><iframe></iframe></td>
    </tr>
  </template:loop>
  
  </table>
</html>


<table summary="Message block header">
<strong class="alert"><t:read var="raise()" source="deep-text()"/></strong>
</table>
</t:switch-prioritized>
