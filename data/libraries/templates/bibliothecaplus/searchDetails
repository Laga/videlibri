<t:switch prioritized="true">
  <html> {reserve-request:=()}
    <head> 
      <meta property="og:image" content="{$book.image-url}"/>?
    </head>
    <body>
      {$book.image-url[] := css(".standardPaddingCover")//(img,input[type="image"])!(@src, tokenize(@sources, "[|]")[contains(.,"://")]) }

  
  
      <div t:condition="contains(@id, 'DivAvailRegionDetail')">
        <t:switch>
          <input type="image" t:condition="contains(@name, 'mediumImageAvailDetail')">{book.orderable := contains(@src, "false.png")}</input>
          <img t:condition="contains(@id, 'mediumImageAvailDetail')">{book.orderable := contains(@src, "false.png")}</img>
          <img t:condition="contains(@id, 'mediumImageDigitalDetail')">{$book("Download !") := ../@href}</img>
        </t:switch>
  
        <input t:test="$book.orderable">{reserve-request := form((//form)[1], {"__EVENTTARGET":  @name})}</input>?
      </div>?
  
      <div t:test="$book.orderable">
         <a t:condition="contains(@id, 'BtnReserve')">{reserve-request := form((//form)[1], {"__EVENTTARGET":  translate(@id, "_", "$")})}</a>?
      </div>
          
    
      <table class="GridViewInnerBorder" t:condition="contains(@id, 'grdViewMediumCopies')">
        <tr><th>{$i := 0}</th></tr>
        <tr>{$book(x"Exemplar {$i := $i + 1}!") := join(td), 
             if (empty(reserve-request)) then reserve-request := .//a[contains(@id, BtnReserve)]/form((//form)[1], {"__EVENTTARGET":  extract(@href, "&#39;([^&#39;]+)&#39;", 1)}) else ()}</tr>+
      </table>
      
      <div t:condition="contains(@id, 'tpnlDetail') or contains(@ id, 'CatalogueDetailView')"><!-- class="DnnContainer">-->
        <div>     
           <span>{cat := .}</span>
           <t:switch>
             <span>{
               let $temp := extract($cat/@id, "_Lbl(.*)$", 1) 
               return if (exists($search-reverse-keys($temp))) then $book($search-reverse-keys($temp)) := .
                      else $book($cat||"!") := .}</span> 
              <a>{$book($cat||"!") := . || (if (contains(@href, "http")) then x" ( {@href} )" else "")}</a>
           </t:switch>
        </div>*
      </div>
      				
    </body>
  </html>

  
  <table t:condition="contains(@id, 'GrdVolumes')">
  <td>
    <a>{$book._volumeFirst := resolve-uri(@href), i := 1, $book("Band 1!") := .}</a>
    <a>{$book(x"Band {$x := $x + 1}!") := .}</a>*
  </td>
  </table>
  
  <span t:condition="contains(@id, 'LblVolumes') and (matches(., '^(Volumes|BÃ¤nde)$')) and empty(ancestor::tr[1]/following::tr[1]//table)"/> <!-- accept pages without volumes, but still try to raise error, if nothing is on the page-->
  
</t:switch>  