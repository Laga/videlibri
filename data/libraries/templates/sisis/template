<?xml version="1.0" encoding="UTF-8"?>
<actions>


<action id="connect">
  <page url="http://{$server}start.do" templateFile="start"/>
</action>

<action id="update-all">
  <page url="http://{$server}login.do;{$jsession}">
    <post name="methodToCall" value="submit"/>
    <post name="CSId" value="{$CSId}"/>
    <post name="username" value="{$username}"/>
    <post name="password" value="{$password}"/>
    
    <template>
    <body>
    <a t:optional="true">deutsch<t:if test="/html/@lang != 'de'">
      <t:read var="raise()" source="concat('VideLibri funktioniert nur, wenn die Sprache des BTH-RWTH-Webkatalogs auf deutsch gesetzt ist.', $line-ending, 'Die Einstellung kann auf der normalen Katalogseite unter Konto / Sucheinstellungen / Sprache geÃ¤ndert werden.', $line-ending, $line-ending, $line-ending, 'VideLibri only works, if the language of the library web catalog is set to German. ', $line-ending, ' You can change the language setting on the normal web page on the  Account / Search preferences / Language page.')"/>
    </t:if></a>
    <form id="LoginBean" t:optional="true">
      <div class="error"><t:read var="raise-login()" source="."/></div>
    </form>
    </body>
    </template>
  </page>
  <page url="http://{$server}userAccount.do;jsession;?methodToCall=show&amp;type=1"  templateFile="loggedIn"></page>
  <!--  <error templateFile="loginError"/>-->
</action>


<action id="renew-single">
  <page url="http://{$server}userAccount.do?methodToCall=renewalPossible&amp;actPos={$book.extendID}" templateFile="singleExtended"/>
</action>


<!--<action id="renew-all">
  <page url="https://{$server}AusleiheVerlaengerungServlet;{$jsession}" templateFile="KontoServlet">
    <post name="Kontoart" value="Ausleihkonto"/>
    <post name="Bibliothek" value="111"/>
    <post name="homegkz" value="111"/>
  </page>
</action>-->

<action id="search">

  <variable name="searchOptions">
  (if ($book.title != "")    ["331", $book.title]    else (),
   if ($book.author != "")   ["100", $book.author]   else (),
   if ($book.isbn != "")     ["540", $book.isbn]     else (),
   if ($book.year != "")     ["425", $book.year]     else (),
   if ($book.keywords != "") ["902", $book.keywords] else ())
  </variable>

  <variable name="searchUrl">
  concat(x"http://{$server}search.do?methodToCall=submit&CSId={$CSId}&methodToCallParameter=submitSearch&",
         x"searchCategories%5B0%5D={$searchOptions[1](1)}&searchString%5B0%5D={$searchOptions[1](2)}&",
         if (count($searchOptions) > 1) x"combinationOperator%5B1%5D=AND&searchCategories%5B1%5D={$searchOptions[2](1)}&searchString%5B1%5D={$searchOptions[2](2)}&" else "",
         if (count($searchOptions) > 2) x"combinationOperator%5B2%5D=AND&searchCategories%5B2%5D={$searchOptions[3](1)}&searchString%5B2%5D={$searchOptions[3](2)}&" else "",
         "submitSearch=Suchen&callingPage=searchParameters"
  )
  </variable>

  <page url="$searchUrl" templateFile="searchList"/>
</action>


</actions> 
