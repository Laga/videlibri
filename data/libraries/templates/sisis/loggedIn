<html>
<head>
<htmlparser:read source="''" var="bookCount"/>
</head>
<body>
   <div id="main"> 
     <div id="middle"> 
        <div id="tab"> <!--There is another div in-between, but its id changes between current1, active1 and label1, so don't check it-->
           Ausleihen<htmlparser:read source="text()" var="bookCount" regex="[0-9]+"/>
           <htmlparser:if test="'$bookCount;' = ''">INVALID CANCEL CURRENT TAG</htmlparser:if>
        </div>
        
  <div id="tab-content">
  

    <div class="box">
      <div class="box-header">
        <h2>Ausleihen</h2>
      </div>
    </div>
    <fieldset>

    <htmlparser:read var="delete-current-books()"/>

    <htmlparser:if test="'$allBooksAway;'==''">
    <table class="data">
      <tr>
        <th scope="col"></th>
      </tr>

      <htmlparser:loop>      

      <tr>
        <th scope="row"></th>
        <htmlparser:read var="book-start()"/>
        <td>
          <strong><htmlparser:read source="text()" var="book.title"/></strong><br/>
          <htmlparser:read source="'true'" var="spanmissing"/>
          <htmlparser:read source="'false'" var="previousspan"/>
          <htmlparser:read source="text()" var="book.author"/><br/>
          <htmlparser:read source="text()" var="book.id" regex="^[^/]*"/><br/>
          <a htmlparser-optional="true">
            <htmlparser:read source="@href" var="book.extendID" regex="actPos=([0-9]+)$" submatch="1"/>
            <span>
              <htmlparser:read source="text()" var="book.status:curious"/>
              <htmlparser:read source="@class != 'textgruen'" var="spanmissing"/>
            </span>
          </a>
	  <span htmlparser-optional="true">
            <htmlparser:read source="text()" var="book.status:problematic"/>
            <htmlparser:read source="'false'" var="spanmissing"/>
            <htmlparser:read source="'true'" var="previousspan"/>
          </span>
<!--	  <htmlparser:if test="'$previousspan;'">
	    <span htmlparser-optional="true">
              <htmlparser:read source="concat('$book.status:problematic; ', text())" var="book.status:problematic"/>
              <htmlparser:read source="'false'" var="spanmissing"/>
            </span>
           </htmlparser:if>-->
         </td>
         <htmlparser:if test="'$spanmissing;'"><broken/></htmlparser:if>
         <td>
           <htmlparser:read source="text()" var="book.issuedate:dd.mm.yyyy" regex="^\d{2}\.\d{2}\.\d{4}"/>
           <htmlparser:read source="text()" var="book.limitdate:dd.mm.yyyy" regex="- *(\d{2}\.\d{2}\.\d{4})" submatch="1"/><br/>
	 </td>
         <htmlparser:read var="book-end()"/>
       </tr>
              
      </htmlparser:loop>      
               
      </table>
      </htmlparser:if>
    </fieldset>

   </div>
  </div>
 </div>
</body>
</html>
  
